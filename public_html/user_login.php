<?php	require_once("common.php");		$json = json_decode(get("json"), true);	//var_dump($json);	function gimme($name)	{		global $json;		if (!isset($json[$name]))			return "";		return trim($json[$name]);	}		function get_session_key($user_id)	{			$key = substr(md5("asodao\$sdashod4/&7{6ohasdha{sio[dh" . time() . mt_rand()), 0, 16);				$time = time();		$sql = "			INSERT INTO user_sessions (`key`, user_id, time_of_creation)			VALUES ('$key', $user_id, $time)					";		$query = mysql_query($sql);				/*		global $result;		$result["sql"] = $sql;		$result["query"] = $query;		$result["mysql_error"] = mysql_error();		*/				return $key;	}		$result = array();		$name_login = mysql_real_escape_string(gimme("name_login"));	$pass = md5(gimme("pass"));	$result["pass_raw"] = gimme("pass");	$result["pass"] = $pass;	if ($name_login == "" || $pass == "")	{		$result["success"] = false;		$result["error"] = "Parameters missing.";	} else {		$sql = "			SELECT id			FROM users			WHERE name_login = '$name_login' AND pass = '$pass'		";		$query = mysql_query($sql);						if (mysql_num_rows($query) == 0)		{			$result["success"] = false;			$result["error"] = "The login data was wrong!";		} else {			$row = mysql_fetch_assoc($query);					$result["session"] = get_session_key($row["id"]);					$result["success"] = true;		}	}		header_for_json();	echo json_encode($result);?>